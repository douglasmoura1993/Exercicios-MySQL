1. Encontre os nomes e cidades de todos os funcionários que trabalham na GM:

CREATE VIEW VW_GM AS SELECT 
FUNC_NOME AS NOME, FUNC_RUA AS ENDERECO, FUNC_CIDADE AS CIDADE,
EMP_NOME FROM FUNCIONARIO LEFT JOIN TRABALHA ON 
FUNCIONARIO.FUNC_COD = TRABALHA.FUNC_COD 
LEFT JOIN EMPRESA E ON E.EMP_COD = TRABALHA.EMP_COD WHERE EMP_NOME = 'GM'; 

SELECT * FROM VW_GM;

2. Encontre os nomes, endereços e cidades de todos os funcionários que trabalham na Toddy e
ganham mais de 3000 reais:

CREATE VIEW VW_SAL AS SELECT 
FUNC_NOME AS NOME, FUNC_RUA AS ENDERECO, FUNC_CIDADE AS CIDADE, EMP_NOME AS EMPRESA, SALARIO
FROM FUNCIONARIO F INNER JOIN TRABALHA T ON F.FUNC_COD = T.FUNC_COD INNER JOIN EMPRESA E
ON E.EMP_COD = T.EMP_COD WHERE EMP_NOME = 'Toddy' AND SALARIO > 3000;

SELECT * FROM VW_SAL;

3. Encontre todos os funcionários que não trabalham na IBM:

CREATE VIEW VW_NOIBM AS SELECT 
FUNC_NOME AS NOME, EMP_NOME AS EMPRESA
FROM FUNCIONARIO F INNER JOIN TRABALHA T ON F.FUNC_COD = T.FUNC_COD
INNER JOIN EMPRESA E ON T.EMP_COD = E.EMP_COD WHERE EMP_NOME NOT LIKE 'IBM';

SELECT * FROM VW_NOIBM;

4. Encontre a média salarial dos funcionários que trabalham na Toddy:

CREATE VIEW MD_SAL AS SELECT 
 ROUND(AVG(SALARIO),2) AS MEDIA, EMP_NOME AS EMPRESA
 FROM TRABALHA T INNER JOIN EMPRESA E ON T.EMP_COD = E.EMP_COD
 WHERE EMP_NOME = 'Toddy';
 
 SELECT * FROM MD_SAL; 

5. Encontre o funcionário que possui o menor salário:

CREATE VIEW VW_MSAL AS SELECT 
MIN(SALARIO), FUNC_NOME AS NOME
FROM TRABALHA T INNER JOIN FUNCIONARIO F ON T.FUNC_COD = F.FUNC_COD;

SELECT * FROM VW_MSAL;


6. Encontre a quantidade de funcionários que trabalham na Toddy:

CREATE VIEW VW_QTDS AS SELECT COUNT(SALARIO)  AS SALARIO, EMP_NOME AS EMPRESA FROM TRABALHA T
LEFT JOIN EMPRESA E ON T.EMP_COD = E.EMP_COD WHERE EMP_NOME = 'Toddy';

SELECT * FROM VW_QTDS;

7. Encontre a média de idade dos funcionários da Toddy.

CREATE VIEW  VW_MIDADE AS SELECT ROUND(AVG(FUNC_IDADE),0)MEDIA_DE_IDADE FROM FUNCIONARIO;

SELECT * FROM VW_MIDADE;
